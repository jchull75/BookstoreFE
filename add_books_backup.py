import sqlite3

# Connect to the database
try:
    conn = sqlite3.connect("bookstore.db")
    cursor = conn.cursor()
    print("Database connection successful!")
except sqlite3.Error as e:
    print(f"Failed to connect to database: {e}")
    exit(1)

# List of books to add (54 books with working thumbnails)
new_books = [
    ("Mickey7", "Edward Ashton", "Sci-Fi", 12.99, 10, "9781250275035",
     "An expendable astronaut, cloned multiple times, battles harsh conditions and isolation to colonize an ice-covered planet, facing existential dilemmas.",
     "http://covers.openlibrary.org/b/isbn/9781250275035-M.jpg"),
    ("Harry Potter and the Sorcerer's Stone", "J.K. Rowling", "Fantasy", 10.99, 10, "9780590353427",
     "Harry Potter discovers he's a wizard, attends Hogwarts, befriends Ron and Hermione, and unravels his past while confronting dark forces.",
     "http://covers.openlibrary.org/b/isbn/9780590353427-M.jpg"),
    ("Harry Potter and the Chamber of Secrets", "J.K. Rowling", "Fantasy", 11.99, 10, "9780439064873",
     "Harry returns to Hogwarts, facing a hidden chamber, a deadly basilisk, and secrets tied to Voldemort that threaten the school's safety.",
     "http://covers.openlibrary.org/b/isbn/9780439064873-M.jpg"),
    ("Harry Potter and the Prisoner of Azkaban", "J.K. Rowling", "Fantasy", 12.99, 10, "9780439136365",
     "Harry learns of his godfather Sirius Black, escapes Azkaban's terror, and uses time-turning magic to uncover dark family truths.",
     "http://covers.openlibrary.org/b/isbn/9780439136365-M.jpg"),
    ("Harry Potter and the Goblet of Fire", "J.K. Rowling", "Fantasy", 14.99, 10, "9780439139595",
     "Harry is thrust into the Triwizard Tournament, battling dragons, merpeople, and Voldemort's return in a dangerous magical competition.",
     "http://covers.openlibrary.org/b/isbn/9780439139595-M.jpg"),
    ("Harry Potter and the Order of the Phoenix", "J.K. Rowling", "Fantasy", 15.99, 10, "9780439358071",
     "Harry forms Dumbledore's Army to resist a rising darkness as Voldemort gains power and the Ministry denies his return.",
     "http://covers.openlibrary.org/b/isbn/9780439358071-M.jpg"),
    ("Harry Potter and the Half-Blood Prince", "J.K. Rowling", "Fantasy", 14.99, 10, "9780439784542",
     "Harry delves into Voldemort's past via memories, battles dark forces, and faces a tragic betrayal at Hogwarts' core.",
     "http://covers.openlibrary.org/b/isbn/9780439784542-M.jpg"),
    ("Harry Potter and the Deathly Hallows", "J.K. Rowling", "Fantasy", 16.99, 10, "9780545010221",
     "Harry, Ron, and Hermione hunt Horcruxes, evade capture, and confront Voldemort in a climactic battle for the wizarding world.",
     "http://covers.openlibrary.org/b/isbn/9780545010221-M.jpg"),
    ("The Shining", "Stephen King", "Horror", 13.99, 10, "9780307743657",
     "Jack Torrance descends into madness at the haunted Overlook Hotel, endangering his family with supernatural forces during a brutal winter.",
     "http://covers.openlibrary.org/b/isbn/9780307743657-M.jpg"),
    ("It", "Stephen King", "Horror", 15.99, 10, "9781501142970",
     "Childhood friends reunite in Derry to battle Pennywise, a shape-shifting entity that feeds on fear and resurfaces every 27 years.",
     "http://covers.openlibrary.org/b/isbn/9781501142970-M.jpg"),
    ("Pet Sematary", "Stephen King", "Horror", 12.99, 10, "9781501156700",
     "Louis Creed buries his cat in a cursed cemetery, unleashing horrific consequences as the dead return twisted and malevolent.",
     "http://covers.openlibrary.org/b/isbn/9781501156700-M.jpg"),
    ("The Stand", "Stephen King", "Post-Apocalyptic", 18.99, 10, "9780307947307",
     "A plague decimates humanity, leaving survivors to choose between good and evil in an epic clash across a desolate America.",
     "http://covers.openlibrary.org/b/isbn/9780307947307-M.jpg"),
    ("Misery", "Stephen King", "Thriller", 11.99, 10, "9781501143106",
     "Author Paul Sheldon is held captive by obsessed fan Annie Wilkes, forced to rewrite his novel under her violent, unhinged demands.",
     "http://covers.openlibrary.org/b/isbn/9781501143106-M.jpg"),
    ("Doctor Sleep", "Stephen King", "Horror", 14.99, 10, "9781982138868",
     "Adult Danny Torrance uses his psychic shine to protect a girl from a cult feeding on children with similar powers.",
     "http://covers.openlibrary.org/b/isbn/9781982138868-M.jpg"),
    ("Carrie", "Stephen King", "Horror", 10.99, 10, "9780307743664",
     "Bullied Carrie White unleashes telekinetic havoc at her prom, exacting fiery revenge on a town that tormented her relentlessly.",
     "http://covers.openlibrary.org/b/isbn/9780307743664-M.jpg"),
    ("11/22/63", "Stephen King", "Historical Fiction", 16.99, 10, "9781451627299",
     "Jake Epping time-travels to 1958 to prevent JFK's assassination, navigating love, danger, and unintended consequences in a gripping tale.",
     "http://covers.openlibrary.org/b/isbn/9781451627299-M.jpg"),
    ("Odd Thomas", "Dean Koontz", "Thriller", 9.99, 10, "9780553584493",
     "Odd Thomas, a fry cook who sees the dead, races to prevent a mass murder foretold by restless spirits in his town.",
     "http://covers.openlibrary.org/b/isbn/9780553584493-M.jpg"),
    ("Watchers", "Dean Koontz", "Horror", 10.99, 10, "9780425221808",
     "Travis and Nora bond with a genius dog, fleeing a monstrous lab escapee in a suspenseful chase across a dark landscape.",
     "http://covers.openlibrary.org/b/isbn/9780425221808-M.jpg"),
    ("Phantoms", "Dean Koontz", "Horror", 12.99, 10, "9780425181102",
     "Dr. Jenny Paige and her sister confront an ancient, shapeless evil that annihilates a town, leaving eerie silence behind.",
     "http://covers.openlibrary.org/b/isbn/9780425181102-M.jpg"),
    ("Strangers", "Dean Koontz", "Thriller", 14.99, 10, "9780425238202",
     "Strangers across America experience bizarre phenomena, uniting to unravel a hidden government conspiracy buried deep in their pasts.",
     "http://covers.openlibrary.org/b/isbn/9780425238202-M.jpg"),
    ("Velocity", "Dean Koontz", "Thriller", 13.99, 10, "9780553589092",
     "Billy Wiles receives cryptic notes forcing him to choose victims for a killer, spiraling into a relentless survival game.",
     "http://covers.openlibrary.org/b/isbn/9780553589092-M.jpg"),
    ("Life Expectancy", "Dean Koontz", "Mystery", 12.99, 10, "9780553588262",
     "Jimmy Tock's birth aligns with a chilling prophecy of five terrible days, weaving a life of danger and unexpected hope.",
     "http://covers.openlibrary.org/b/isbn/9780553588262-M.jpg"),
    ("Dragon Tears", "Dean Koontz", "Thriller", 10.99, 10, "9780425241271",
     "Detectives Harry and Connie hunt a supernatural killer with reality-warping powers, racing to stop his relentless, bloody rampage.",
     "http://covers.openlibrary.org/b/isbn/9780425241271-M.jpg"),
    ("Frankenstein: Prodigal Son", "Dean Koontz", "Sci-Fi", 9.99, 10, "9780553593327",
     "In New Orleans, Deucalion, Frankenstein's creation, seeks redemption while battling Victor's new horde of monstrous experiments.",
     "http://covers.openlibrary.org/b/isbn/9780553593327-M.jpg"),
    ("The Road", "Cormac McCarthy", "Post-Apocalyptic", 13.99, 10, "9780307387899",
     "A father and son trek through a bleak, ash-covered America, scavenging and evading dangers after a devastating global catastrophe.",
     "http://covers.openlibrary.org/b/isbn/9780307387899-M.jpg"),
    ("Dune", "Frank Herbert", "Sci-Fi", 15.99, 10, "9780441013593",
     "Paul Atreides rises on Arrakis, mastering the desert and the spice amid political intrigue and ecological challenges of epic scale.",
     "http://covers.openlibrary.org/b/isbn/9780441013593-M.jpg"),
    ("1984", "George Orwell", "Dystopian", 9.99, 10, "9780451524935",
     "Winston Smith defies a totalitarian regime's surveillance and propaganda, seeking truth and freedom in a world stripped of both.",
     "http://covers.openlibrary.org/b/isbn/9780451524935-M.jpg"),
    ("Brave New World", "Aldous Huxley", "Dystopian", 10.99, 10, "9780060850524",
     "Bernard Marx questions a society of engineered humans pacified by drugs, revealing conformity's steep cost in a futuristic nightmare.",
     "http://covers.openlibrary.org/b/isbn/9780060850524-M.jpg"),
    ("Fahrenheit 451", "Ray Bradbury", "Sci-Fi", 11.99, 10, "9781451673319",
     "Guy Montag, a fireman who burns books, rebels against a society banning knowledge, seeking meaning in a censored world.",
     "http://covers.openlibrary.org/b/isbn/9781451673319-M.jpg"),
    ("The Hobbit", "J.R.R. Tolkien", "Fantasy", 14.99, 10, "9780547928227",
     "Bilbo Baggins joins dwarves and Gandalf on a quest to reclaim treasure from Smaug, discovering courage in Middle-earth's wilds.",
     "http://covers.openlibrary.org/b/isbn/9780547928227-M.jpg"),
    ("The Lord of the Rings: The Fellowship of the Ring", "J.R.R. Tolkien", "Fantasy", 15.99, 10, "9780547928210",
     "Frodo inherits a powerful ring, forming a fellowship to destroy it and thwart Sauron's dark dominion over Middle-earth.",
     "http://covers.openlibrary.org/b/isbn/9780547928210-M.jpg"),
    ("The Lord of the Rings: The Two Towers", "J.R.R. Tolkien", "Fantasy", 15.99, 10, "9780547928203",
     "The fellowship splits as Frodo and Sam near Mordor, while allies wage war against Sauron's forces across Middle-earth.",
     "http://covers.openlibrary.org/b/isbn/9780547928203-M.jpg"),
    ("The Lord of the Rings: The Return of the King", "J.R.R. Tolkien", "Fantasy", 15.99, 10, "9780547928197",
     "Frodo reaches Mount Doom to destroy the ring as Aragorn leads a final stand against Sauron's army.",
     "http://covers.openlibrary.org/b/isbn/9780547928197-M.jpg"),
    ("To Kill a Mockingbird", "Harper Lee", "Classic", 9.99, 10, "9780061120084",
     "Scout Finch watches Atticus defend an innocent Black man in 1930s Alabama, exposing prejudice in a small Southern town.",
     "http://covers.openlibrary.org/b/isbn/9780061120084-M.jpg"),
    ("The Great Gatsby", "F. Scott Fitzgerald", "Classic", 10.99, 10, "9780743273565",
     "Jay Gatsby chases wealth and Daisy's love in the Jazz Age, unveiling the hollow pursuit of the American Dream.",
     "http://covers.openlibrary.org/b/isbn/9780743273565-M.jpg"),
    ("Pride and Prejudice", "Jane Austen", "Romance", 9.99, 10, "9781503290563",
     "Elizabeth Bennet overcomes pride and prejudice to find love with Mr. Darcy in Regency England's rigid social hierarchy.",
     "http://covers.openlibrary.org/b/isbn/9781503290563-M.jpg"),
    ("Frankenstein", "Mary Shelley", "Gothic", 8.99, 10, "9780486282114",
     "Victor Frankenstein's creation, rejected and lonely, sparks a tragic cycle of revenge and despair in this haunting gothic tale.",
     "http://covers.openlibrary.org/b/isbn/9780486282114-M.jpg"),
    ("The Catcher in the Rye", "J.D. Salinger", "Classic", 10.99, 10, "9780316769488",
     "Holden Caulfield wanders New York, grappling with alienation and the phoniness of adulthood after expulsion from prep school.",
     "http://covers.openlibrary.org/b/isbn/9780316769488-M.jpg"),
    ("The Alchemist", "Paulo Coelho", "Adventure", 12.99, 10, "9780062315007",
     "Santiago, an Andalusian shepherd, follows omens across deserts to find treasure, uncovering his personal legend in a mystical journey.",
     "http://covers.openlibrary.org/b/isbn/9780062315007-M.jpg"),
    ("The Book Thief", "Markus Zusak", "Historical Fiction", 11.99, 10, "9780375842207",
     "Liesel Meminger steals books to survive Nazi Germany's horrors, finding solace in words as Death narrates her poignant story.",
     "http://covers.openlibrary.org/b/isbn/9780375842207-M.jpg"),
    ("The Night Circus", "Erin Morgenstern", "Fantasy", 12.99, 10, "9780307744432",
     "Celia and Marco duel magically in a mystical circus, their love growing despite stakes set by their manipulative mentors.",
     "http://covers.openlibrary.org/b/isbn/9780307744432-M.jpg"),
    ("Where the Crawdads Sing", "Delia Owens", "Mystery", 14.99, 10, "9780735219106",
     "Kya Clark, the Marsh Girl, grows up isolated, facing suspicion and romance in a murder mystery set in nature's wilds.",
     "http://covers.openlibrary.org/b/isbn/9780735219106-M.jpg"),
    ("The Midnight Library", "Matt Haig", "Fantasy", 13.99, 10, "9780525559474",
     "Nora Seed explores infinite lives in a magical library between life and death, seeking happiness amid endless possibilities.",
     "http://covers.openlibrary.org/b/isbn/9780525559474-M.jpg"),
    ("Project Hail Mary", "Andy Weir", "Sci-Fi", 15.99, 10, "9780593135204",
     "Ryland Grace, amnesiac astronaut, pieces together his mission to reverse Earth's solar dimming, alone in a vast cosmos.",
     "http://covers.openlibrary.org/b/isbn/9780593135204-M.jpg"),
    ("Circe", "Madeline Miller", "Mythology", 14.99, 10, "9780316556347",
     "Exiled nymph Circe masters witchcraft, encounters gods and heroes, and carves her own destiny on a mythical island.",
     "http://covers.openlibrary.org/b/isbn/9780316556347-M.jpg"),
    ("The Silent Patient", "Alex Michaelides", "Thriller", 12.99, 10, "9781250301697",
     "Alicia Berenson stops speaking after killing her husband; a therapist unravels her silence, revealing a twisted psychological truth.",
     "http://covers.openlibrary.org/b/isbn/9781250301697-M.jpg"),
    ("Before We Were Strangers", "Renée Carlino", "Romance", 11.99, 10, "9781501105777",
     "Matt and Grace, college lovers, reconnect after fifteen years, rekindling a romance lost to time and life's unexpected turns.",
     "http://covers.openlibrary.org/b/isbn/9781501105777-M.jpg"),
    ("Verity", "Colleen Hoover", "Thriller", 12.99, 10, "9781791392796",
     "Lowen Ashleigh uncovers Verity Crawford's chilling manuscript, blurring reality and deception in a dark, suspenseful family mystery.",
     "http://covers.openlibrary.org/b/isbn/9781791392796-M.jpg"),
    ("Batman: The Killing Joke", "Alan Moore, Brian Bolland", "Superhero / Psychological Thriller", 14.99, 5, "9781401216672",
     "A dark, psychological look into the Joker's origins and his twisted relationship with Batman.",
     "http://covers.openlibrary.org/b/isbn/9781401216672-M.jpg"),
    ("Watchmen", "Alan Moore, Dave Gibbons", "Superhero / Dystopian", 19.99, 3, "9780930289232",
     "A groundbreaking graphic novel that deconstructs the superhero genre in a gripping alternative history.",
     "http://covers.openlibrary.org/b/isbn/9780930289232-M.jpg"),
    ("Spider-Man: Kraven's Last Hunt", "J.M. DeMatteis, Mike Zeck", "Superhero / Psychological Thriller", 19.99, 15, "9780785134510",
     "One of the darkest Spider-Man stories, featuring Kraven the Hunter as he seeks to prove he is superior to Peter Parker.",
     "http://covers.openlibrary.org/b/isbn/9780785134510-M.jpg"),
    ("Batman: The Killing Joke", "Alan Moore, Brian Bolland", "Superhero / Psychological Thriller", 12.99, 20, "9781401216678",
     "A deep dive into the Joker's origins and his attempt to drive Commissioner Gordon insane, pushing Batman to his limits.",
     "http://covers.openlibrary.org/b/isbn/9781401216678-M.jpg"),
    ("Civil War", "Mark Millar, Steve McNiven", "Superhero / Action", 24.99, 18, "9780785121794",
     "A conflict erupts between Captain America and Iron Man when the government introduces the Superhuman Registration Act.",
     "http://covers.openlibrary.org/b/isbn/9780785121794-M.jpg"),
    ("The Infinity Gauntlet", "Jim Starlin, George Pérez, Ron Lim", "Superhero / Cosmic", 29.99, 12, "9780785156598",
     "The story that inspired Avengers: Infinity War, where Thanos collects the Infinity Stones and wipes out half of all life.",
     "http://covers.openlibrary.org/b/isbn/9780785156598-M.jpg"),
    ("X-Men: Dark Phoenix Saga", "Chris Claremont, John Byrne", "Superhero / Sci-Fi", 19.99, 14, "9780785122135",
     "The iconic story of Jean Grey's transformation into the all-powerful Phoenix and the devastating consequences that follow.",
     "http://covers.openlibrary.org/b/isbn/9780785122135-M.jpg"),
    ("Batman: The Long Halloween", "Jeph Loeb, Tim Sale", "Superhero / Crime Noir", 17.99, 16, "9781563894695",
     "A murder mystery that takes place over a year in Gotham, influencing The Dark Knight movie.",
     "http://covers.openlibrary.org/b/isbn/9781563894695-M.jpg"),
    ("Wolverine: Old Man Logan", "Mark Millar, Steve McNiven", "Superhero / Post-Apocalyptic", 25.00, 10, "9780785196211",
     "An older Wolverine in a dystopian future where supervillains rule the world, forced into one last mission.",
     "http://covers.openlibrary.org/b/isbn/9780785196211-M.jpg"),
    ("Thor: God of Thunder - The God Butcher", "Jason Aaron, Esad Ribic", "Superhero / Fantasy", 17.99, 13, "9780785168423",
     "Thor faces Gorr the God Butcher, a terrifying enemy hunting gods across time.",
     "http://covers.openlibrary.org/b/isbn/9780785168423-M.jpg"),
    ("The Walking Dead: Compendium One", "Robert Kirkman", "Horror / Post-Apocalyptic", 39.99, 10, "9781607060765",
     "The first collection of the acclaimed series about a group of survivors navigating a world ravaged by a zombie apocalypse.",
     "http://covers.openlibrary.org/b/isbn/9781607060765-M.jpg"),
    ("The Walking Dead: Compendium Two", "Robert Kirkman", "Horror / Post-Apocalyptic", 39.99, 10, "9781607065965",
     "Continuing the harrowing journey of Rick Grimes and his group as they face new threats and challenges in a world overrun by the undead.",
     "http://covers.openlibrary.org/b/isbn/9781607065965-M.jpg"),
    ("The Walking Dead: Compendium Three", "Robert Kirkman", "Horror / Post-Apocalyptic", 39.99, 10, "9781632154569",
     "The saga continues as alliances are formed and shattered, and the survivors confront both external threats and internal conflicts.",
     "http://covers.openlibrary.org/b/isbn/9781632154569-M.jpg"),
    ("The Walking Dead: Compendium Four", "Robert Kirkman", "Horror / Post-Apocalyptic", 39.99, 10, "9781534313408",
     "The final compendium concludes the epic story of survival, hope, and humanity in the face of a relentless zombie apocalypse.",
     "http://covers.openlibrary.org/b/isbn/9781534313408-M.jpg"),
    ("Batman: Hush", "Jeph Loeb, Jim Lee", "Superhero / Mystery", 24.99, 18, "1401223171",
     "A thrilling Batman mystery with a new villain, Hush, who knows all of Bruce Wayne’s secrets.",
     "http://covers.openlibrary.org/b/isbn/1401223171-M.jpg"),
]

# Add books to the database, skipping duplicates based on ISBN
for book in new_books:
    try:
        cursor.execute("SELECT COUNT(*) FROM Books WHERE isbn = ?", (book[5],))
        count = cursor.fetchone()[0]
        if count == 0:
            cursor.execute(
                "INSERT INTO Books (title, author, genre, price, quantity, isbn, description, cover_image) "
                "VALUES (?, ?, ?, ?, ?, ?, ?, ?)", book
            )
            print(f"Added: {book[0]}")
        else:
            print(f"Skipped (duplicate ISBN): {book[0]}")
    except sqlite3.Error as e:
        print(f"Error processing {book[0]}: {e}")

# Commit changes and close connection
try:
    conn.commit()
    print("Added new books without duplicates!")
except sqlite3.Error as e:
    print(f"Failed to commit changes: {e}")
finally:
    conn.close()
    print("Database connection closed.")